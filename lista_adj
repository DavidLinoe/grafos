# lista de adjacencia
def criar_grafo():
    return {}


def inserir_vertice(grafo, vertice):

    if vertice not in grafo:
        grafo[vertice] = []

    else: print(f"Vértice {vertice} já existe.")


def inserir_aresta(grafo, origem, destino, nao_direcionado=False):
    inserir_vertice(grafo, origem)
    inserir_vertice(grafo, destino)

    if destino not in grafo[origem]:
        grafo[origem].append(destino)

    if nao_direcionado and origem not in grafo[destino]:
        grafo[destino].append(origem)


def vizinhos(grafo, vertice):
    return grafo.get(vertice, [])


def listar_vizinhos(grafo, vertice):
    lista = vizinhos(grafo, vertice)
    if not lista and vertice not in grafo:
        print(f"Vértice '{vertice}' não existe no grafo.")
        return []
    print(f"Vizinhos de {vertice}: {lista}")
    return lista


def exibir_grafo(grafo):
    if not grafo:
        print("Grafo vazio.")
        return

    print("Grafo (lista de adjacência):")
    for vertice in sorted(grafo.keys()):
        print(f"  {vertice} -> {grafo[vertice]}")


def remover_aresta(grafo, origem, destino, nao_direcionado=False):
    if origem not in grafo:
        return

    if destino in grafo[origem]:
        grafo[origem].remove(destino)

    if nao_direcionado and destino in grafo:
        if origem in grafo[destino]:
            grafo[destino].remove(origem)


def remover_vertice(grafo, vertice, nao_direcionado=True):
    if vertice not in grafo:
        return

    for outro in list(grafo.keys()):
        if outro != vertice and vertice in grafo[outro]:
            grafo[outro].remove(vertice)

    del grafo[vertice]


def existe_aresta(grafo, origem, destino):
    return origem in grafo and destino in grafo[origem]


def grau_vertices(grafo):
    graus = {v: {'in': 0, 'out': 0, 'total': 0} for v in grafo}

    for u in grafo:
        graus[u]['out'] = len(grafo[u])
        for v in grafo[u]:
            if v in graus:
                graus[v]['in'] += 1

    for v in graus:
        graus[v]['total'] = graus[v]['in'] + graus[v]['out']

    return graus


def percurso_valido(grafo, caminho):
    if len(caminho) < 2:
        return True

    for i in range(len(caminho) - 1):
        origem = caminho[i]
        destino = caminho[i + 1]
        if not existe_aresta(grafo, origem, destino):
            return False
    return True


def main():
    grafo = criar_grafo()
    while True:
        print("\n" + "="*40)
        print("     MENU DE OPERAÇÕES NO GRAFO")
        print("="*40)
        print("1  - Mostrar o Grafo")
        print("2  - Inserir Vértice")
        print("3  - Inserir Aresta")
        print("4  - Remover Vértice")
        print("5  - Remover Aresta")
        print("6  - Listar Vizinhos de um Vértice")
        print("7  - Verificar se Existe Aresta")
        print("8  - Exibir Graus dos Vértices")
        print("9  - Verificar Percurso Válido")
        print("0  - Sair")
        print("="*40)

        opcao = input("Escolha uma opção: ").strip()

        if opcao == '1':
            exibir_grafo(grafo)

        elif opcao == '2':
            vertice = input("Nome do vértice: ").strip()
            inserir_vertice(grafo, vertice)
            print(f"Vértice '{vertice}' inserido.")

        elif opcao == '3':
            origem = input("Vértice de origem: ").strip()
            destino = input("Vértice de destino: ").strip()
            tipo = input("É não direcionado? (s/n): ").strip().lower()
            nao_dir = tipo == 's'
            inserir_aresta(grafo, origem, destino, nao_dir)
            tipo_str = "não direcionado" if nao_dir else "direcionado"
            print(f"Aresta {origem} → {destino} ({tipo_str}) inserida.")

        elif opcao == '4':
            vertice = input("Vértice a remover: ").strip()
            remover_vertice(grafo, vertice)
            print(f"Vértice '{vertice}' removido.")

        elif opcao == '5':
            origem = input("Vértice de origem: ").strip()
            destino = input("Vértice de destino: ").strip()
            tipo = input("É não direcionado? (s/n): ").strip().lower()
            nao_dir = tipo == 's'
            remover_aresta(grafo, origem, destino, nao_dir)
            print(f"Aresta {origem} → {destino} removida.")

        elif opcao == '6':
            vertice = input("Vértice para listar vizinhos: ").strip()
            listar_vizinhos(grafo, vertice)

        elif opcao == '7':
            origem = input("Vértice de origem: ").strip()
            destino = input("Vértice de destino: ").strip()
            if existe_aresta(grafo, origem, destino):
                print(f"Sim, existe aresta {origem} → {destino}")
            else:
                print(f"Não existe aresta {origem} → {destino}")

        elif opcao == '8':
            graus = grau_vertices(grafo)
            print("\nGraus dos vértices:")
            for v, g in graus.items():
                print(f"  {v}: entrada={g['in']}, saída={g['out']}, total={g['total']}")

        elif opcao == '9':
            entrada = input("Digite o caminho (separado por espaços): ").strip()
            caminho = [v.strip() for v in entrada.split()]
            if percurso_valido(grafo, caminho):
                print(f"O percurso {' -> '.join(caminho)} é VÁLIDO.")
            else:
                print(f"O percurso {' -> '.join(caminho)} é INVÁLIDO.")

        elif opcao == '0':
            break

        else:
            print("Opção inválida! Tente novamente.")


if __name__ == "__main__":
    main()
